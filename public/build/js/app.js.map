{"version":3,"sources":["app.js"],"names":["paso","pasoInicial","pasoFinla","cita","id","nombre","fecha","hora","servicios","iniciarApp","mostrarSecion","tabs","botonesPaginador","paginaSiguiente","paginaAnterior","consultarAPI","idCliente","nombreCliente","seleccionarFecha","seleccionarHora","mostrarResumen","seccionAnterior","document","querySelector","classList","remove","pasoSelector","add","tabAnterior","querySelectorAll","forEach","boton","addEventListener","event","parseInt","target","dataset","async","url","location","origin","resultado","fetch","mostrarServicios","json","error","console","log","servicio","precio","nombreServicio","createElement","textContent","precioServicio","servicioDIV","idServicio","onclick","seleccionarServicio","appendChild","divServicio","some","agregado","filter","value","dia","Date","getUTCDay","includes","mostrarAlerta","split","mensaje","tipo","elemento","desaparece","alertaPrevia","alerta","setTimeout","resumen","firstChild","removeChild","Object","values","length","headerServicio","contenedorServicio","textoServicio","innerHTML","headerCita","fechaObj","mes","getMonth","getDate","year","getFullYear","fechaFormateada","UTC","toLocaleDateString","weekday","month","day","fechaCliente","horaCliente","botonReservar","reservarCita","map","datos","FormData","append","respuesta","method","body","Swal","fire","icon","title","text","then","window","reload"],"mappings":"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","file":"app.js","sourcesContent":["\r\nlet paso = 1\r\nconst pasoInicial = 1\r\nconst pasoFinla = 3\r\n\r\nconst cita = {\r\n   id: '',\r\n   nombre: '',\r\n   fecha: '',\r\n   hora: '',\r\n   servicios: []\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n   iniciarApp()\r\n})\r\n\r\nfunction iniciarApp() {\r\n   mostrarSecion()\r\n   tabs()\r\n   botonesPaginador()\r\n   paginaSiguiente()\r\n   paginaAnterior()\r\n\r\n   consultarAPI()\r\n\r\n   idCliente()\r\n   nombreCliente()\r\n   seleccionarFecha()\r\n   seleccionarHora()\r\n   mostrarResumen()\r\n}\r\n\r\nfunction mostrarSecion() {\r\n\r\n   // Ocultar la seccion anterior\r\n   const seccionAnterior = document.querySelector('.mostrar')\r\n   if(seccionAnterior) {\r\n      seccionAnterior.classList.remove('mostrar')\r\n   }\r\n   \r\n   // Seleccionar la seccion co el paso\r\n   const pasoSelector = `#paso-${paso}`\r\n   const seccion = document.querySelector(pasoSelector)\r\n   seccion.classList.add('mostrar')\r\n\r\n   // Quitar la clase Anterior\r\n   const tabAnterior = document.querySelector('.actual')\r\n   if(tabAnterior) {\r\n      tabAnterior.classList.remove('actual')\r\n   }\r\n\r\n   // Resalta el Tab actual\r\n   const tab = document.querySelector(`[data-paso=\"${paso}\"]`)\r\n   tab.classList.add('actual')\r\n\r\n}\r\n\r\nfunction tabs() {\r\n\r\n   const botones = document.querySelectorAll('.tabs button')\r\n\r\n   botones.forEach( boton => {\r\n      boton.addEventListener('click', function(event) {\r\n         paso = parseInt( event.target.dataset.paso )\r\n         mostrarSecion()\r\n         botonesPaginador()\r\n      })\r\n   })\r\n\r\n}\r\n\r\nfunction botonesPaginador() {\r\n\r\n   const paginaAnterior = document.querySelector('#anterior')\r\n   const paginaSiguiente = document.querySelector('#siguiente')\r\n\r\n   if(paso === 1) {\r\n      paginaAnterior.classList.add('ocultar')\r\n      paginaSiguiente.classList.remove('ocultar')\r\n   } else if(paso === 3) {\r\n      paginaAnterior.classList.remove('ocultar')\r\n      paginaSiguiente.classList.add('ocultar')\r\n      mostrarResumen()\r\n   } else {\r\n      paginaAnterior.classList.remove('ocultar')\r\n      paginaSiguiente.classList.remove('ocultar')\r\n   }\r\n\r\n   mostrarSecion()\r\n   \r\n}\r\n\r\nfunction paginaAnterior() {\r\n\r\n   const paginaAnterior = document.querySelector('#anterior')\r\n   paginaAnterior.addEventListener('click', function() {\r\n      if(paso <= pasoInicial) return\r\n      paso--\r\n      botonesPaginador();\r\n   })\r\n\r\n}\r\n\r\nfunction paginaSiguiente() {\r\n\r\n   const paginaSiguiente = document.querySelector('#siguiente')\r\n   paginaSiguiente.addEventListener('click', function() {\r\n      if(paso >= pasoFinla) return\r\n      paso++\r\n      botonesPaginador();\r\n   })\r\n\r\n}\r\n\r\nasync function consultarAPI() {\r\n\r\n   try {\r\n\r\n      const url = `${location.origin}/api/servicios`\r\n      const resultado = await fetch(url)\r\n      const servicios = await resultado.json()\r\n      mostrarServicios(servicios)\r\n      \r\n   } catch (error) {\r\n      console.log(error)      \r\n   }\r\n\r\n}\r\n\r\nfunction mostrarServicios(servicios) {\r\n\r\n   servicios.forEach( servicio => {\r\n      const {id, nombre, precio } = servicio\r\n\r\n      const nombreServicio = document.createElement('P')\r\n      nombreServicio.classList.add('nombre-servicio')\r\n      nombreServicio.textContent = nombre\r\n\r\n      const precioServicio = document.createElement('P')\r\n      precioServicio.classList.add('precio-servicio')\r\n      precioServicio.textContent = `$${precio}`\r\n\r\n      const servicioDIV = document.createElement('DIV')\r\n      servicioDIV.classList.add('servicio')\r\n      servicioDIV.dataset.idServicio = id\r\n      servicioDIV.onclick = function() {\r\n         seleccionarServicio(servicio)\r\n      }\r\n\r\n      servicioDIV.appendChild(nombreServicio)\r\n      servicioDIV.appendChild(precioServicio)\r\n\r\n      document.querySelector('#servicios').appendChild(servicioDIV)\r\n\r\n   })\r\n\r\n}\r\n\r\nfunction seleccionarServicio(servicio) {\r\n\r\n   const {id} = servicio\r\n   const {servicios} = cita\r\n\r\n   const divServicio = document.querySelector(`[data-id-servicio=\"${id}\"]`)\r\n\r\n   if( servicios.some( agregado => agregado.id === id )) {\r\n      cita.servicios = servicios.filter( agregado => agregado.id !== id)\r\n      divServicio.classList.remove('seleccionado')\r\n   } else {\r\n      cita.servicios = [...servicios, servicio]\r\n      divServicio.classList.add('seleccionado')\r\n   }\r\n\r\n}\r\n\r\nfunction idCliente() {\r\n\r\n   cita.id = document.querySelector('#id').value\r\n\r\n}\r\n\r\nfunction nombreCliente() {\r\n\r\n   cita.nombre = document.querySelector('#nombre').value\r\n\r\n}\r\n\r\nfunction seleccionarFecha() {\r\n\r\n   const inputFecha = document.querySelector('#fecha')\r\n   inputFecha.addEventListener('input', function(event) {\r\n      \r\n      const dia = new Date(event.target.value).getUTCDay()\r\n      if( [6, 0].includes(dia)) {\r\n         event.target.value = ''\r\n         mostrarAlerta('Fines de semana no permitido', 'error','.formulario')\r\n      } else {\r\n         cita.fecha = event.target.value\r\n      }\r\n\r\n   })\r\n   \r\n}\r\n\r\nfunction seleccionarHora() {\r\n\r\n   const inputHora = document.querySelector('#hora')\r\n   inputHora.addEventListener('input', function(event) {\r\n\r\n      const horaCita = event.target.value\r\n      const hora = horaCita.split(':')[0]\r\n      if(hora < 10 || hora > 18) {\r\n         event.target.value = ''\r\n         mostrarAlerta('Hora no válida','error','.formulario')\r\n      } else {\r\n         cita.hora = event.target.value\r\n      }\r\n\r\n   })\r\n\r\n}\r\n\r\nfunction mostrarAlerta(mensaje, tipo, elemento, desaparece = true) {\r\n\r\n   // Prevenir generar muchas alertas\r\n   const alertaPrevia = document.querySelector('.alerta')\r\n   if(alertaPrevia) {\r\n      alertaPrevia.remove()\r\n   }\r\n\r\n   // Scripting para crear Alertas\r\n   const alerta = document.createElement('DIV')\r\n   alerta.textContent = mensaje\r\n   alerta.classList.add('alerta')\r\n   alerta.classList.add(tipo)\r\n\r\n   const referencia = document.querySelector(elemento)\r\n   referencia.appendChild(alerta)\r\n\r\n   if(desaparece) {\r\n      // Eliminar alerta\r\n      setTimeout(() => {\r\n         alerta.remove()\r\n      }, 3000);\r\n   }\r\n\r\n}\r\n\r\nfunction mostrarResumen() {\r\n\r\n   const resumen = document.querySelector('.contenido-resumen')\r\n\r\n   // Limpiar el contenido de Resumen\r\n   while(resumen.firstChild) {\r\n      resumen.removeChild(resumen.firstChild)\r\n   }\r\n\r\n   if( Object.values(cita).includes('') || cita.servicios.length === 0 ) {\r\n      mostrarAlerta('Faltan Datos de Servicios, Fecha u Hora', 'error','.contenido-resumen', false)\r\n      return\r\n   }\r\n\r\n   const {nombre, fecha, hora, servicios} = cita\r\n\r\n   const headerServicio = document.createElement('H3')\r\n   headerServicio.textContent = 'Resumen de Servicios'\r\n   resumen.appendChild(headerServicio)\r\n\r\n   servicios.forEach(servicio => {\r\n\r\n      const {id, nombre, precio} = servicio\r\n\r\n      const contenedorServicio = document.createElement('DIV')\r\n      contenedorServicio.classList.add('contenedor-servicio')\r\n\r\n      const textoServicio = document.createElement('P')\r\n      textoServicio.textContent = nombre\r\n\r\n      const precioServicio = document.createElement('P')\r\n      precioServicio.innerHTML = `<span>Precio: $</span> ${precio}`\r\n\r\n      contenedorServicio.appendChild(textoServicio)\r\n      contenedorServicio.appendChild(precioServicio)\r\n\r\n      resumen.appendChild(contenedorServicio)\r\n\r\n   })\r\n\r\n   const headerCita = document.createElement('H3')\r\n   headerCita.textContent = 'Resumen de Cita'\r\n   resumen.appendChild(headerCita)\r\n\r\n   const nombreCliente = document.createElement('P')\r\n   nombreCliente.innerHTML = `<span>Nombre: </span>${nombre}`\r\n\r\n   // Formatear Fecha\r\n   const fechaObj = new Date(fecha)\r\n   const mes = fechaObj.getMonth()\r\n   const dia = fechaObj.getDate() + 2\r\n   const year = fechaObj.getFullYear()\r\n\r\n   const fechaUTC = new Date( Date.UTC(year, mes, dia) )\r\n\r\n   const opciones = {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'}\r\n   const fechaFormateada = fechaUTC.toLocaleDateString('es-ES', opciones)\r\n\r\n   const fechaCliente = document.createElement('P')\r\n   fechaCliente.innerHTML = `<span>Fecha: </span>${fechaFormateada}`\r\n\r\n   const horaCliente = document.createElement('P')\r\n   horaCliente.innerHTML = `<span>Hora: </span>${hora}`\r\n\r\n   // Boton para Crear un Cita\r\n   const botonReservar = document.createElement('BUTTON')\r\n   botonReservar.classList.add('boton')\r\n   botonReservar.textContent = 'Reservar Cita'\r\n   botonReservar.onclick = reservarCita\r\n\r\n   resumen.appendChild(nombreCliente)\r\n   resumen.appendChild(fechaCliente)\r\n   resumen.appendChild(horaCliente)\r\n\r\n   resumen.appendChild(botonReservar)\r\n\r\n}\r\n\r\nasync function reservarCita() {\r\n\r\n   const {nombre, fecha, hora, servicios, id} = cita\r\n\r\n   const idServicio = servicios.map(servicio => servicio.id)\r\n\r\n   const datos = new FormData()\r\n   \r\n   datos.append('hora', hora)\r\n   datos.append('fecha', fecha)\r\n   datos.append('usuarioID', id)\r\n   datos.append('servicios', idServicio)\r\n\r\n   try {\r\n      const url = `${location.origin}/api/citas`\r\n      const respuesta = await fetch(url, {\r\n         method: 'POST',\r\n         body: datos\r\n      })\r\n\r\n      const resultado = await respuesta.json()\r\n\r\n      if(resultado.resultado) {\r\n         Swal.fire({\r\n            icon: \"success\",\r\n            title: \"Cita Creada\",\r\n            text: \"Tu cita fue creada correctamente\"\r\n         }).then( () => {\r\n            setTimeout(() => {\r\n               window.location.reload()\r\n            }, 3000)\r\n         })\r\n      }\r\n   } catch (error) {\r\n      Swal.fire({\r\n         icon: \"error\",\r\n         title: \"Error\",\r\n         text: \"Hubo un error al guardar la cita\"\r\n      });\r\n   }\r\n\r\n   \r\n\r\n}"]}